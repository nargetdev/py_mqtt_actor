session_name: mqtt-actor-test
windows:
  - window_name: allstuffs
    layout: even-vertical
    panes:
      - shell_command:
          - docker compose up emqx
      - shell_command:
          - docker compose up function-based-actor
      - shell_command:
          - |
            echo "Waiting for emqx to be ready..."
            while not nc -z localhost 1883
                sleep 2
            end
            echo "emqx is ready, starting mosquitto_sub for RESP/#"
            docker compose up test-function-based-actor
      - shell_command:
          - |
            echo "Waiting for emqx to be ready..."
            while not nc -z localhost 1883
                sleep 1
            end
            echo "emqx is ready, starting mosquitto_sub for RESP/#"
            mosquitto_sub -t RESP/#
      - shell_command:
          - |
            echo "Waiting for emqx to be ready..."
            while not nc -z localhost 1883
                sleep 1
            end
            echo "emqx is ready, starting mosquitto_sub for SYNC/#"
            mosquitto_sub -t SYNC/#